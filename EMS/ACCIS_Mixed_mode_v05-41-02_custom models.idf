!ACCIS v05.20

!TODO:
!Parametrizar el vent opening factor; ahora mismo es 1 o 0, y se podria parametrizar en funcion de la velocidad maxima del viento; estudiar con cuidado porque seria una variable para zada zona aplicada a las ventanas
!Permitir la seleccion del modelo estatico aplicado cuando no se cumple aplicabilidad del adaptativo como una segunda variable
todo añadir argumentos para modificar los modelos de confort

!PENDIENTE DE ARREGLAR:
! HAY QUE MODIFICAR EL SCRIPT DE PYTHON PARA QUE AÑADA UN FORSCRIPT_SCHEDULE PARA CADA ZONA, PARA QUE PUEDA ACTIVARSE O DESACTIVARSE EL HVAC INDEPENDIENTEMENTE DE LAS OTRAS.
! ADEMÁS HABRÁ QUE HACER UN FOR LOOP PARA ASIGNAR A CADA ZONA SU DUALSETPOINTTEMPERATURE, QUE SERÁ EL FORSCRIPT DE LA ZONA CORRESPONDIENTE
! HAY QUE COMPROBAR QUE EL PROGRAMA ApplyAST_MixedMode FUNCIONA CORRECTAMENTE DESPUÉS DE ESOS CAMBIOS. QUIZÁS HAYA QUE ASIGNAR EL FORSCRIPT AL AST EN UN PROGRAMA PARALELO CON LoopZoneIDFName



!Para que funcione correctamente:
  !- No debe haber otro script que contenta variables con los mismos nombres que este script; por lo tanto, no se puede duplicar y cambiar datos. La opcion mas recomendable es exportar el IDF, cambiar datos del script y guardar como un archivo de texto distinto.
  !- Se debe usar Detailed HVAC system con Detailed HVAC data: el sistema debe ser un sistema VRF sin AHU
	!- Se debe usar ventilacion natural calculada
  !- Los datos Adaptive Thermal Comfort Cost Index (Timestep/Hourly), Adaptive Thermal Comfort Cost Index (DailyAverage), Adaptive Thermal Comfort Cost Index (MonthlyAverage) y Adaptive Thermal Comfort Cost Index (YearlyAverage) deben ser consultados en frecuencia timestep. Correspondientemente, deben ser consultados en el primer timestep del dia (para ver el DailyAverage del dia anterior, y asi sucesivamente con el mes y año. Ademas, hay que tener en cuenta que los resultados de cada zona tienen como consumo el total de todas laz zonas, por lo que unicamente seria correcto si solo hubiera una zona termica; en caso de hacer el promedio del ATCCI de cada zona, se obtiene un valor aproximado al real, pero no exactamente el mismo.
  !- Si los Timesteps son superiores a 6, el valor promedio anual de ATCCI (Adaptive Thermal Comfort Cost Index (YearlyAverage)) dara un valor incorrecto. Para cambiar el numero de timesteps, es necesario llevar a cabo el siguiente cambio mas adelante en el script:

!EnergyManagementSystem:TrendVariable,
!HvacEcTL,
!HVACEnergyCost,
!52560;                          !6 timesteps en todo el año; si se quiere incrementar el numero de timesteps, este numero debe ser 8760 * Numero de timesteps

!EnergyManagementSystem:TrendVariable,
!ChAtcciTL_LoopZoneVariableName,
!ComfHoursNoApp_LoopZoneVariableName,
!52560;                          !6 timesteps en todo el año; si se quiere incrementar el numero de timesteps, este numero debe ser 8760 * Numero de timesteps

!ACCIS (Adaptive Comfort Control Implementation Script)

!DATOS EDITABLES

EnergyManagementSystem:ProgramCallingManager,
SetInputData,
	BeginTimestepBeforePredictor,
	SetInputData;

	EnergyManagementSystem:Program,
    SetInputData,
	    !Modificar para cambiar de norma: 0=CTE; 1 = EN16798-1; 2 = ASHRAE 55; 3 = JPN; 4 = GB/T 50785 - Cold; 5 = GB/T 50785 - Hot & Mild; 6 = IMAC - NV; 7 = IMAC - MM
	    set ComfStand = 3,
	    !Modificar para cambiar de Categoria o Aceptabilidad: 1 = CAT I; 2 = CAT II; 3 = CAT III; 80 = 80% ACCEPT; 90 = 90% ACCEPT
	    set CAT = 3,
	    !Eleccion del modelo de confort: 0 = Static; 1 = OUT-CTE; 2 = OUT-SENXXXXX/SASHRAE55; 3 = OUT-AENXXXXX/AASHRAE55
	    set ComfMod = 3,
		!Modo del systema HVAC: 0 = Fully Air-conditioned; 1 = Naturally ventilated; 2 = Mixed mode
		set HVACmode = 2,
		!Modo de ventilacion natural: 0 = Ventila por encima de la neutral; 1=Ventila por encima del limite superior de confort
		set VentCtrl = 0,
		set VSToffset = 0, !Este valor se sumara a la consigna de ventilacion. Solo se usa cuando VentCtrl = 0
		set MinOToffset = 15, !Este valor se restara al AHST, por lo que debe ser positivo. Es la temperatura minima exterior para ventilacion. Solo se usa si HVACmode = 2.
		set MaxWindSpeed = 6, !Maxima velocidad del viento en ventilacion. Por encima, las ventanas se cierran.
		!Aplicacion de una tolerancia a las consignas adaptativas
	    set ACSTtol = -0.25,             !Este valor se sumara a la consigna adaptativa de refrigeracion. Debe ser negativo o 0.
	    set AHSTtol = 0.25,              !Este valor se sumara a la consigna adaptativa de calefaccion. Debe ser positivo o 0.ç
		set CoolSeasonStart = 121,
		set CoolSeasonEnd = 274;


!NO EDITAR NADA A PARTIR DE AQUI

!DEFINICION DE VARIABLES

EnergyManagementSystem:GlobalVariable,
    ACST,                           !Temperatura de consigna adaptativa de refrigeracion (Adaptive Cooling Setpoint Temperature)
    AHST,                           !Temperatura de consigna adaptativa de calefaccion (Adaptive Heating Setpoint Temperature)
    ACSTnoTol,                      !Temperatura de consigna adaptativa de refrigeracion sin tolerancia
    AHSTnoTol,                      !Temperatura de consigna adaptativa de calefaccion sin tolerancia
    ComfStand,                      !Norma usada
    ACSTaul,                        !Limite superior de aplicabilidad del limite superior de confort (Adaptive Cooling Setpoint Temperature applicability upper limit)
    ACSTall,                        !Limite inferior de aplicabilidad del limite superior de confort (Adaptive Cooling Setpoint Temperature applicability lower limit)
    AHSTaul,                        !Limite superior de aplicabilidad del limite inferior de confort (Adaptive Heating Setpoint Temperature applicability upper limit)
    AHSTall,                        !Limite inferior de aplicabilidad del limite inferior de confort (Adaptive Heating Setpoint Temperature applicability lower limit)
    CAT,                            !Categoria usada
    ACSToffset,                     !Amplitud de la consigna de refrigeracion respecto a la temperatura neutral
    AHSToffset,                     !Amplitud de la consigna de calefaccion respecto a la temperatura neutral
    ComfMod,                        !Modelo de confort usado
    ComfTemp,                       !Temperatura neutral
    ACSTtol,                        !Tolerancia para la consigna de refrigeracion
    AHSTtol,                        !Tolerancia para la consigna de calefaccion
	<ForAllOccupiedZones>
	ComfHours_<LoopZoneVariableName>,                      !Hora de confort
	DiscomfAppHotHours_<LoopZoneVariableName>,             !Hora aplicable de disconfort por calor
	DiscomfAppColdHours_<LoopZoneVariableName>,            !Hora aplicable de disconfort por frio
	DiscomfNonAppHotHours_<LoopZoneVariableName>,          !Hora no aplicable de disconfort por calor
	DiscomfNonAppColdHours_<LoopZoneVariableName>,         !Hora no aplicable de disconfort por frio
	ComfHoursNoApp_<LoopZoneVariableName>,                 !Horas de confort para calculo de ATCCI
	VentHours_<LoopZoneVariableName>,
	OccHours_<LoopZoneVariableName>,
	OccComfHoursNoApp_<LoopZoneVariableName>,
	NormHeatDem_<LoopZoneVariableName>,
	NormCoolDem_<LoopZoneVariableName>,
	NormHeatCon_<LoopZoneVariableName>,
	NormCoolCon_<LoopZoneVariableName>,
	ZoneFloorArea_<LoopZoneVariableName>,
	ZoneAirVolume_<LoopZoneVariableName>,
	<LoopNextZone>
	VST, !Temperatura de consigna para ventilacion
	VSToffset,
	MaxWindSpeed,
	VentCtrl, !Modo de control de temperatura
	HVACmode, !Modo de operacion del edificio
	MinOutTemp,
	MinOToffset,
	MaxTempDiffVOF,
	MinTempDiffVOF,
	MultiplierVOF,
	TempDiffVOF,
	SetpointAcc,
	CoolSeasonStart,
	CoolSeasonEnd,
	<ForAllExternalWindows>
	<LoopWindowVariableName>_MyVOF,
	<LoopNextWindow>;




!SENSORES

EnergyManagementSystem:Sensor,
RMOT,                        !Running Mean Outdoor Temperature
    People <Any_Occupied_ZoneIDFName>,
    Zone Thermal Comfort CEN 15251 Adaptive Model Running Average Outdoor Air Temperature;

EnergyManagementSystem:Sensor,
PMOT,                        !Prevailing Mean Outdoor Temperature
    People <Any_Occupied_ZoneIDFName>,
    Zone Thermal Comfort ASHRAE 55 Adaptive Model Running Average Outdoor Air Temperature;


<ForAllOccupiedZones>
EnergyManagementSystem:Sensor,
<LoopZoneVariableName>_OpT,                      !Temperatura Operativa - LoopZone
	<LoopZoneIDFName>,
	Zone Operative Temperature;

EnergyManagementSystem:Sensor,
<LoopZoneVariableName>_CoolCoil,
 <LoopZoneIDFName> VRF Indoor Unit DX Cooling Coil,
 Cooling Coil Total Cooling Rate;

EnergyManagementSystem:Sensor,
<LoopZoneVariableName>_HeatCoil,
 <LoopZoneIDFName> VRF Indoor Unit DX Heating Coil,
 Heating Coil Heating Rate;

EnergyManagementSystem:Sensor,
<LoopZoneVariableName>_WindSpeed,
    <LoopZoneIDFName>,
    Zone Outdoor Air Wind Speed;

EnergyManagementSystem:Sensor,
<LoopZoneVariableName>_OutT,
 <LoopZoneIDFName>,
 Zone Outdoor Air Drybulb Temperature;

 EnergyManagementSystem:Sensor,
Occ_count_<LoopZoneVariableName>,
    People <LoopZoneIDFName>,
    People Occupant Count;
<LoopNextZone>

<ForAllExternalWindows>
EnergyManagementSystem:Sensor,
<LoopWindowVariableName>_OpT,                      !Temperatura Operativa - LoopWindowZone
	<LoopWindowZoneIDFName>,
	Zone Operative Temperature;

EnergyManagementSystem:Sensor,
<LoopWindowVariableName>_CoolCoil,
 <LoopWindowZoneIDFName> VRF Indoor Unit DX Cooling Coil,
 Cooling Coil Total Cooling Rate;

EnergyManagementSystem:Sensor,
<LoopWindowVariableName>_HeatCoil,
 <LoopWindowZoneIDFName> VRF Indoor Unit DX Heating Coil,
 Heating Coil Heating Rate;

EnergyManagementSystem:Sensor,
<LoopWindowVariableName>_WindSpeed,
    <LoopWindowZoneIDFName>,
    Zone Outdoor Air Wind Speed;

EnergyManagementSystem:Sensor,
<LoopWindowVariableName>_OutT,
 <LoopWindowZoneIDFName>,
 Zone Outdoor Air Drybulb Temperature;

  EnergyManagementSystem:Sensor,
<LoopWindowVariableName>_Occ_count,
    People <LoopWindowZoneIDFName>,
    People Occupant Count;

<LoopNextWindow>

EnergyManagementSystem:Sensor,
OutT,
 Environment,
 Site Outdoor Air Drybulb Temperature;

!Programa: Aplicacion de la temperatura neutral

EnergyManagementSystem:ProgramCallingManager,
SetComfTemp,
    BeginTimestepBeforePredictor,
    SetComfTemp;

    EnergyManagementSystem:Program,
    SetComfTemp,
        if ComfStand == 99,
		    set ComfTemp = PMOT*0.31+17.8,
	    elseif ComfStand == 1,
		    set ComfTemp = RMOT*0.33+18.8,
	    elseif ComfStand == 2,
		    set ComfTemp = PMOT*0.31+17.8,
		elseif ComfStand == 3,
		    set ComfTemp = PMOT*0.48+14.4,
        elseif ComfStand == 4,
            set ComfTemp = 0,
        elseif ComfStand == 5,
            set ComfTemp = 0,
        elseif ComfStand == 6,
            set ComfTemp = 0,
        elseif ComfStand == 7,
            set ComfTemp = PMOT*0.54+12.83,
        elseif ComfStand == 8,
            set ComfTemp = PMOT*0.28+17.87,
        elseif ComfStand == 9,
            set ComfTemp = PMOT*0.39+18.42,
        elseif ComfStand == 10,
            set ComfTemp = PMOT*0.42+17.6,
        elseif ComfStand == 11,
            set ComfTemp = PMOT*0.75+5.37,
        elseif ComfStand == 12,
            set ComfTemp = PMOT*0.25+19.7,
        elseif ComfStand == 13,
            set ComfTemp = PMOT*0.26+15.9,
        elseif ComfStand == 14,
            set ComfTemp = PMOT*0.26+16.75,
        elseif ComfStand == 15,
            set ComfTemp = PMOT*0.56+12.74,
        elseif ComfStand == 16,
            set ComfTemp = PMOT*0.09+22.32,
		elseif ComfStand == 17,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ComfTemp = PMOT*0.48+13.9,
			else,
				set ComfTemp = PMOT*0.59+9.6,
			endif,
		elseif ComfStand == 18,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ComfTemp = PMOT*0.84+5.3,
			else,
				set ComfTemp = PMOT*0.96-3.6,
			endif,
		elseif ComfStand == 19,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ComfTemp = PMOT*0.27+17.9,
			else,
				set ComfTemp = PMOT*0.53+10.3,
			endif,
		elseif ComfStand == 20,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ComfTemp = PMOT*0.38+15.7,
			else,
				set ComfTemp = PMOT*0.47+9.07,
			endif,
		elseif ComfStand == 21,
			set ComfTemp = PMOT*0.678+13.51,
	    endif;

!Programa: Conteo de las horas de confort

EnergyManagementSystem:ProgramCallingManager,
CountHours,
	BeginTimestepBeforePredictor,
	CountHours;

	EnergyManagementSystem:Program,
	CountHours,
	<ForAllOccupiedZones>
	if (ComfStand == 1) || (ComfStand == 10),
		if (RMOT >= AHSTall) && (RMOT <= ACSTaul),
		    if (<LoopZoneVariableName>_OpT <= ACSTnoTol),
				if (<LoopZoneVariableName>_OpT >= AHSTnoTol),
		     		set ComfHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
				    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
				    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
				    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
				    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
				endif,
		    elseif (<LoopZoneVariableName>_OpT > ACSTnoTol),
			    set ComfHours_<LoopZoneVariableName> = 0,
			    set DiscomfAppHotHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
			    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
			    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
			    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
		    elseif (<LoopZoneVariableName>_OpT < AHSTnoTol),
			    set ComfHours_<LoopZoneVariableName> = 0,
			    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
			    set DiscomfAppColdHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
			    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
			    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
		    endif,
	    elseif (RMOT > ACSTaul),
		    set ComfHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
		    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
		    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
	    elseif (RMOT < AHSTall),
		    set ComfHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
		    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
		    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
		endif,
	else,
	    if (PMOT >= AHSTall) && (PMOT <= ACSTaul),
		    if (<LoopZoneVariableName>_OpT <= ACSTnoTol),
				if (<LoopZoneVariableName>_OpT >= AHSTnoTol),
				    set ComfHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
				    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
				    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
				    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
				    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
				endif,
		    elseif (<LoopZoneVariableName>_OpT > ACSTnoTol),
			    set ComfHours_<LoopZoneVariableName> = 0,
			    set DiscomfAppHotHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
			    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
			    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
			    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
		    elseif (<LoopZoneVariableName>_OpT < AHSTnoTol),
			    set ComfHours_<LoopZoneVariableName> = 0,
			    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
			    set DiscomfAppColdHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
			    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
			    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
		    endif,
	    elseif (PMOT > ACSTaul),
		    set ComfHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
		    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
		    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 0,
	    elseif (PMOT < AHSTall),
		    set ComfHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppHotHours_<LoopZoneVariableName> = 0,
		    set DiscomfAppColdHours_<LoopZoneVariableName> = 0,
		    set DiscomfNonAppHotHours_<LoopZoneVariableName> = 0,
		    set DiscomfNonAppColdHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
	    endif,
	endif,
	<LoopNextZone>;

!Programa: Aplicacion de las categorias

EnergyManagementSystem:ProgramCallingManager,
SetAppLimits,
    BeginTimestepBeforePredictor,
    SetAppLimits;

	EnergyManagementSystem:Program,
	SetAppLimits,
    if ComfStand == 99,
		set ACSTaul = 33.5,
		set ACSTall = 10,
		set AHSTaul = 33.5,
		set AHSTall = 10,
	elseif ComfStand == 1,
		set ACSTaul = 30,
		set ACSTall = 10,
		set AHSTaul = 30,
		set AHSTall = 10,
	elseif ComfStand == 2 || ComfStand == 12,
		set ACSTaul = 33.5,
		set ACSTall = 10,
		set AHSTaul = 33.5,
		set AHSTall = 10,
	elseif ComfStand == 3,
		set ACSTaul = 30,
		set ACSTall = 5,
		set AHSTaul = 30,
		set AHSTall = 5,
    elseif (ComfStand == 4) || (ComfStand == 5),
        if CAT == 1,
            set ACSTaul = 28,
            set ACSTall = 18,
            set AHSTaul = 28,
            set AHSTall = 18,
        elseif CAT == 2,
            set ACSTaul = 30,
            set ACSTall = 18,
            set AHSTaul = 28,
            set AHSTall = 16,
        else,
    		set ACSTaul = 50,
    		set ACSTall = 50,
    		set AHSTaul = 50,
    		set AHSTall = 50,
        endif,
    elseif ComfStand == 6,
		set ACSTaul = 30,
		set ACSTall = -7,
		set AHSTaul = 30,
		set AHSTall = -7,
    elseif ComfStand == 7,
		set ACSTaul = 31,
		set ACSTall = 12.5,
		set AHSTaul = 31,
		set AHSTall = 12.5,
    elseif ComfStand == 8,
		set ACSTaul = 38.5,
		set ACSTall = 13,
		set AHSTaul = 38.5,
		set AHSTall = 13,
    elseif ComfStand == 9 || ComfStand == 10 || ComfStand == 11,
        set ACSTaul = 33,
        set ACSTall = 5.5,
        set AHSTaul = 33,
        set AHSTall = 5.5,
    elseif ComfStand == 13,
		set ACSTaul = 25,
		set ACSTall = 10,
		set AHSTaul = 25,
		set AHSTall = 10,
    elseif ComfStand == 14,
		set ACSTaul = 27,
		set ACSTall = 8,
		set AHSTaul = 27,
		set AHSTall = 8,
    elseif ComfStand == 15,
		set ACSTaul = 24.8,
		set ACSTall = 16.9,
		set AHSTaul = 24.8,
		set AHSTall = 16.9,
    elseif ComfStand == 16,
		set ACSTaul = 25.7,
		set ACSTall = 16.4,
		set AHSTaul = 25.7,
		set AHSTall = 16.4,
	elseif ComfStand == 17,
		if (DayOfYear <= 121) || (DayOfYear > 295),
			set ACSTaul = 25.25,
			set ACSTall = 11.25,
			set AHSTaul = 25.25,
			set AHSTall = 11.25,
		else,
			set ACSTaul = 45,
			set ACSTall = 23,
			set AHSTaul = 45,
			set AHSTall = 23,
		endif,
	elseif ComfStand == 18,
		if (DayOfYear <= 121) || (DayOfYear > 295),
			set ACSTaul = 27.5,
			set ACSTall = 15.5,
			set AHSTaul = 27.5,
			set AHSTall = 15.5,
		else,
			set ACSTaul = 34,
			set ACSTall = 23,
			set AHSTaul = 34,
			set AHSTall = 23,
		endif,
	elseif ComfStand == 19,
		if (DayOfYear <= 121) || (DayOfYear > 295),
			set ACSTaul = 25.25,
			set ACSTall = 5,
			set AHSTaul = 25.25,
			set AHSTall = 5,
		else,
			set ACSTaul = 25.25,
			set ACSTall = 11.75,
			set AHSTaul = 25.25,
			set AHSTall = 11.75,
		endif,
	elseif ComfStand == 20,
		if (DayOfYear <= 121) || (DayOfYear > 295),
			set ACSTaul = 29.75,
			set ACSTall = 13,
			set AHSTaul = 29.75,
			set AHSTall = 13,
		else,
			set ACSTaul = 45,
			set ACSTall = 23,
			set AHSTaul = 45,
			set AHSTall = 23,
		endif,
	elseif ComfStand == 21,
		set ACSTaul = 20,
		set ACSTall = 6.5,
		set AHSTaul = 20,
		set AHSTall = 6.5,
    else,
		set ACSTaul = 50,
		set ACSTall = 50,
		set AHSTaul = 50,
		set AHSTall = 50,
	endif;


!Programa: Aplicacion de las categorias

EnergyManagementSystem:ProgramCallingManager,
ApplyCAT,
    BeginTimestepBeforePredictor,
    ApplyCAT;

	EnergyManagementSystem:Program,
	ApplyCAT,
	set CATcoolOffset = 2,
    set CATheatOffset = 2,
    if ComfStand == 99,
        set ACSToffset = 3.5+CATcoolOffset,
        set AHSToffset = -3.5+CATheatOffset,
	elseif (ComfStand == 1 ),
		if (CAT == 1),
			set ACSToffset = 2+CATcoolOffset,
			set AHSToffset = -3+CATheatOffset,
		elseif (CAT == 2),
			set ACSToffset = 3+CATcoolOffset,
			set AHSToffset = -4+CATheatOffset,
		elseif (CAT == 3),
			set ACSToffset = 4+CATcoolOffset,
			set AHSToffset = -5+CATheatOffset,
		endif,
	elseif ComfStand == 2 || ComfStand == 3 || ComfStand == 11,
		if (CAT == 90),
			set ACSToffset = 2.5+CATcoolOffset,
			set AHSToffset = -2.5+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 3.5+CATcoolOffset,
			set AHSToffset = -3.5+CATheatOffset,
		endif,
    elseif (ComfStand == 4 ) || (ComfStand == 5) || (ComfStand == 6),
        set ACSToffset = 0+CATcoolOffset,
        set AHSToffset = 0+CATheatOffset,
    elseif (ComfStand == 7),
		if (CAT == 90),
			set ACSToffset = 2.4+CATcoolOffset,
			set AHSToffset = -2.4+CATheatOffset,
		elseif (CAT == 85),
			set ACSToffset = 3.3+CATcoolOffset,
			set AHSToffset = -3.3+CATheatOffset,
        elseif (CAT == 80),
            set ACSToffset = 4.1+CATcoolOffset,
            set AHSToffset = -4.1+CATheatOffset,
        endif,
    elseif (ComfStand == 8),
		if (CAT == 90),
			set ACSToffset = 3.5+CATcoolOffset,
			set AHSToffset = -3.5+CATheatOffset,
		elseif (CAT == 85),
			set ACSToffset = 4.8+CATcoolOffset,
			set AHSToffset = -4.8+CATheatOffset,
        elseif (CAT == 80),
            set ACSToffset = 5.9+CATcoolOffset,
            set AHSToffset = -5.9+CATheatOffset,
		endif,
    elseif ComfStand == 9 || ComfStand == 10,
		if (CAT == 90),
			set ACSToffset = 2.15+CATcoolOffset,
			set AHSToffset = -2.15+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 3.6+CATcoolOffset,
			set AHSToffset = -3.6+CATheatOffset,
		endif,
    elseif ComfStand == 12,
		if (CAT == 90),
			set ACSToffset = 1.7+CATcoolOffset,
			set AHSToffset = -1.7+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 2.89+CATcoolOffset,
			set AHSToffset = -2.89+CATheatOffset,
		endif,
    elseif ComfStand == 13,
		if (CAT == 90),
			set ACSToffset = 3.45+CATcoolOffset,
			set AHSToffset = -3.45+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 4.55+CATcoolOffset,
			set AHSToffset = -4.55+CATheatOffset,
		endif,
    elseif ComfStand == 14,
		if (CAT == 90),
			set ACSToffset = 3.5+CATcoolOffset,
			set AHSToffset = -3.5+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 4.5+CATcoolOffset,
			set AHSToffset = -4.5+CATheatOffset,
		endif,
    elseif ComfStand == 15,
		if (CAT == 90),
			set ACSToffset = 2.8+CATcoolOffset,
			set AHSToffset = -2.8+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 3.8+CATcoolOffset,
			set AHSToffset = -3.8+CATheatOffset,
		endif,
    elseif ComfStand == 16,
		if (CAT == 90),
			set ACSToffset = 1.1+CATcoolOffset,
			set AHSToffset = -1.1+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 2.1+CATcoolOffset,
			set AHSToffset = -2.1+CATheatOffset,
		endif,
	elseif (ComfStand == 17) || (ComfStand == 18),
		if CAT == 90,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ACSToffset = 2+CATcoolOffset,
				set AHSToffset = -2+CATheatOffset,
			else,
				set ACSToffset = 2+CATcoolOffset,
				set AHSToffset = -2+CATheatOffset,
			endif,
		elseif CAT == 80,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ACSToffset = 3+CATcoolOffset,
				set AHSToffset = -3+CATheatOffset,
			else,
				set ACSToffset = 3+CATcoolOffset,
				set AHSToffset = -3+CATheatOffset,
			endif,
		endif,
	elseif ComfStand == 19,
		if CAT == 90,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ACSToffset = 2+CATcoolOffset,
				set AHSToffset = -2+CATheatOffset,
			else,
				set ACSToffset = 1+CATcoolOffset,
				set AHSToffset = -1+CATheatOffset,
			endif,
		elseif CAT == 80,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ACSToffset = 3+CATcoolOffset,
				set AHSToffset = -3+CATheatOffset,
			else,
				set ACSToffset = 2+CATcoolOffset,
				set AHSToffset = -2+CATheatOffset,
			endif,
		endif,
	elseif ComfStand == 20,
		if CAT == 90,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ACSToffset = 2+CATcoolOffset,
				set AHSToffset = -2+CATheatOffset,
			else,
				set ACSToffset = 5+CATcoolOffset,
				set AHSToffset = -5+CATheatOffset,
			endif,
		elseif CAT == 80,
			if (DayOfYear <= 121) || (DayOfYear > 295),
				set ACSToffset = 3+CATcoolOffset,
				set AHSToffset = -3+CATheatOffset,
			else,
				set ACSToffset = 6+CATcoolOffset,
				set AHSToffset = -6+CATheatOffset,
			endif,
		endif,
	elseif ComfStand == 21,
		if (CAT == 90),
			set ACSToffset = 2.5+CATcoolOffset,
			set AHSToffset = -2.5+CATheatOffset,
		elseif (CAT == 80),
			set ACSToffset = 4+CATcoolOffset,
			set AHSToffset = -4+CATheatOffset,
		endif,
    endif;

!Programa: establecimiento de las consignas adaptativas

EnergyManagementSystem:ProgramCallingManager,
SetAST,
    BeginTimestepBeforePredictor,
    SetAST;

	EnergyManagementSystem:Program,
	SetAST,
	set SetpointAcc = 10000,
    set m = 0.31,
    set n = 17.8,

	if CoolSeasonEnd > CoolSeasonStart,
		if (DayOfYear >= CoolSeasonStart) && (DayOfYear < CoolSeasonEnd),
			set CoolingSeason = 1,
		else,
			set CoolingSeason = 0,
		endif,
	elseif CoolSeasonStart > CoolSeasonEnd,
		if (DayOfYear >= CoolSeasonStart) || (DayOfYear < CoolSeasonEnd),
			set CoolingSeason = 1,
		else,
			set CoolingSeason = 0,
		endif,
	endif,

    if (ComfStand == 99) && (ComfMod == 3),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*m+n+ACSToffset+ACSTtol,
		elseif RMOT < ACSTall,
			set ACST = ACSTall*m+n+ACSToffset+ACSTtol,
		elseif RMOT > ACSTaul,
			set ACST = ACSTaul*m+n+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 99) && (ComfMod == 3),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*m+n+AHSToffset+AHSTtol,
		elseif RMOT < AHSTall,
			set AHST = AHSTall*m+n+AHSToffset+AHSTtol,
		elseif RMOT > AHSTaul,
			set AHST = AHSTaul*m+n+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 0) && (CurrentTime < 8),
		set ACST = 27+ACSTtol,
		set AHST = 17+AHSTtol,
	elseif (ComfStand == 0) && (CurrentTime < 16),
		set ACST = 25+ACSTtol,
		set AHST = 20+AHSTtol,
	elseif (ComfStand == 0) && (CurrentTime < 23),
		set ACST = 25+ACSTtol,
		set AHST = 20+AHSTtol,
	elseif (ComfStand == 0) && (CurrentTime < 24),
		set ACST = 27+ACSTtol,
		set AHST = 17+AHSTtol,
	endif,

	if (ComfStand == 1) && (ComfMod == 0),
		if CoolingSeason == 1,
			if (CAT==1),
				set ACST = 25.5+ACSTtol,
			elseif (CAT==2),
				set ACST = 26+ACSTtol,
			elseif (CAT==3),
				set ACST = 27+ACSTtol,
			endif,
		else,
			if (CAT==1),
				set ACST = 25+ACSTtol,
			elseif (CAT==2),
				set ACST = 25+ACSTtol,
			elseif (CAT==3),
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 0),
		if CoolingSeason == 1,
			if (CAT==1),
				set AHST = 23.5+AHSTtol,
			elseif (CAT==2),
				set AHST = 23+AHSTtol,
			elseif (CAT==3),
				set AHST = 22+AHSTtol,
			endif,
		else,
			if (CAT==1),
				set AHST = 21+AHSTtol,
			elseif (CAT==2),
				set AHST = 20+AHSTtol,
			elseif (CAT==3),
				set AHST = 18+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 1),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*0.33+18.8+ACSToffset+ACSTtol,
		elseif CurrentTime < 7,
			set ACST = 27+ACSTtol,
		elseif CurrentTime < 15,
			set ACST = 50,
		elseif CurrentTime < 23,
			set ACST = 25+ACSTtol,
		elseif CurrentTime < 24,
			set ACST = 27+ACSTtol,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 1),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*0.33+18.8+AHSToffset+AHSTtol,
		elseif CurrentTime < 7,
			set AHST = 17+AHSTtol,
		elseif CurrentTime < 23,
			set AHST = 20+AHSTtol,
		elseif CurrentTime < 24,
			set AHST = 17+AHSTtol,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 2),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*0.33+18.8+ACSToffset+ACSTtol,
		elseif (RMOT < ACSTall) && (CAT==1),
			set ACST = 25+ACSTtol,
		elseif (RMOT > ACSTaul) && (CAT==1),
			set ACST = 25.5+ACSTtol,
		elseif (RMOT < ACSTall) && (CAT==2),
			set ACST = 25+ACSTtol,
		elseif (RMOT > ACSTaul) && (CAT==2),
			set ACST = 26+ACSTtol,
		elseif (RMOT < ACSTall) && (CAT==3),
			set ACST = 25+ACSTtol,
		elseif (RMOT > ACSTaul) && (CAT==3),
			set ACST = 27+ACSTtol,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 2),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*0.33+18.8+AHSToffset+AHSTtol,
		elseif (RMOT < AHSTall) && (CAT==1),
			set AHST = 21+AHSTtol,
		elseif (RMOT > AHSTaul) && (CAT==1),
			set AHST = 23.5+AHSTtol,
		elseif (RMOT < AHSTall) && (CAT==2),
			set AHST = 20+AHSTtol,
		elseif (RMOT > AHSTaul) && (CAT==2),
		    set AHST = 23+AHSTtol,
		elseif (RMOT < AHSTall) && (CAT==3),
			set AHST = 18+AHSTtol,
		elseif (RMOT > AHSTaul) && (CAT==3),
			set AHST = 22+AHSTtol,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 3),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*0.33+18.8+ACSToffset+ACSTtol,
		elseif RMOT < ACSTall,
			set ACST = ACSTall*0.33+18.8+ACSToffset+ACSTtol,
		elseif RMOT > ACSTaul,
			set ACST = ACSTaul*0.33+18.8+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 1) && (ComfMod == 3),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*0.33+18.8+AHSToffset+AHSTtol,
		elseif RMOT < AHSTall,
			set AHST = AHSTall*0.33+18.8+AHSToffset+AHSTtol,
		elseif RMOT > AHSTaul,
			set AHST = AHSTaul*0.33+18.8+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 0),
		if CoolingSeason == 1,
			if (CAT==80),
				set ACST = 27+ACSTtol,
			elseif (CAT==90),
				set ACST = 26+ACSTtol,
			endif,
		else,
			if (CAT==80),
				set ACST = 25+ACSTtol,
			elseif (CAT==90),
				set ACST = 24+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 0),
		if CoolingSeason == 1,
			if (CAT==80),
				set AHST = 22+AHSTtol,
			elseif (CAT==90),
				set AHST = 23+AHSTtol,
			endif,
		else,
			if (CAT==80),
				set AHST = 19+AHSTtol,
			elseif (CAT==90),
				set AHST = 20+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.31+17.8+ACSToffset+ACSTtol,
		elseif CurrentTime < 7,
			set ACST = 27+ACSTtol,
		elseif CurrentTime < 15,
			set ACST = 50,
		elseif CurrentTime < 23,
			set ACST = 25+ACSTtol,
		elseif CurrentTime < 24,
			set ACST = 27+ACSTtol,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.31+17.8+AHSToffset+AHSTtol,
		elseif CurrentTime < 7,
			set AHST = 17+AHSTtol,
		elseif CurrentTime < 23,
			set AHST = 20+AHSTtol,
		elseif CurrentTime < 24,
			set AHST = 17+AHSTtol,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.31+17.8+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.31+17.8+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.31+17.8+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.31+17.8+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.31+17.8+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 2) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.31+17.8+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.31+17.8+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.31+17.8+AHSToffset+AHSTtol,
		endif,
	endif,

    if (ComfStand == 3) && (ComfMod == 0),
		if (CAT==80),
			set ACST = 28+ACSTtol,
		elseif (CAT==90),
			set ACST = 27+ACSTtol,
		endif,
	endif,

	if (ComfStand == 3) && (ComfMod == 0),
		if (CAT==80),
			set AHST = 18+AHSTtol,
		elseif (CAT==90),
			set AHST = 19+AHSTtol,
		endif,
	endif,

    if (ComfStand == 3) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.48+14.4+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 28+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 28+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 27+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 3) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.48+14.4+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 18+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 18+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 19+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 3) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.48+14.4+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 3) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.48+14.4+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 3) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.48+14.4+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.48+14.4+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.48+14.4+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 3) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.48+14.4+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.48+14.4+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.48+14.4+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 4) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			if CAT == 1,
				set ACST = PMOT*0.77+12.04+ACSTtol,
			elseif CAT == 2,
				set ACST = PMOT*0.73+15.28+ACSTtol,
			endif,
		elseif PMOT < ACSTall,
			if CAT == 1,
				set ACST = ACSTall*0.77+12.04+ACSTtol,
			elseif CAT == 2,
				set ACST = ACSTall*0.73+15.28+ACSTtol,
			endif,
		elseif PMOT > ACSTaul,
			if CAT == 1,
				set ACST = ACSTaul*0.77+12.04+ACSTtol,
			elseif CAT == 2,
				set ACST = ACSTaul*0.73+15.28+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 4) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			if CAT == 1,
				set AHST = PMOT*0.87+2.76+AHSTtol,
			elseif CAT == 2,
				set AHST = PMOT*0.91-0.48+AHSTtol,
			endif,
		elseif PMOT < AHSTall,
			if CAT == 1,
				set AHST = AHSTall*0.87+2.76+AHSTtol,
			elseif CAT == 2,
				set AHST = AHSTall*0.91-0.48+AHSTtol,
			endif,
		elseif PMOT > AHSTaul,
			if CAT == 1,
				set AHST = AHSTaul*0.87+2.76+AHSTtol,
			elseif CAT == 2,
				set AHST = AHSTaul*0.91-0.48+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 5) && (ComfMod == 3),
        if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
            if CAT == 1,
    		    set ACST = PMOT*0.77+9.34+ACSTtol,
            elseif CAT == 2,
                set ACST = PMOT*0.73+12.72+ACSTtol,
			endif,
		elseif PMOT < ACSTall,
			if CAT == 1,
				set ACST = ACSTall*0.77+9.34+ACSTtol,
			elseif CAT == 2,
				set ACST = ACSTall*0.73+12.72+ACSTtol,
			endif,
		elseif PMOT > ACSTaul,
			if CAT == 1,
				set ACST = ACSTaul*0.77+9.34+ACSTtol,
			elseif CAT == 2,
				set ACST = ACSTaul*0.73+12.72+ACSTtol,
			endif,
        endif,
    endif,

	if (ComfStand == 5) && (ComfMod == 3),
        if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
            if CAT == 1,
                set AHST = PMOT*0.87-0.31+AHSTtol,
            elseif CAT == 2,
                set AHST = PMOT*0.91-3.69+AHSTtol,
			endif,
		elseif PMOT < AHSTall,
			if CAT == 1,
				set AHST = AHSTall*0.87-0.31+AHSTtol,
			elseif CAT == 2,
				set AHST = AHSTall*0.91-3.69+AHSTtol,
			endif,
		elseif PMOT > AHSTaul,
			if CAT == 1,
				set AHST = AHSTaul*0.87-0.31+AHSTtol,
			elseif CAT == 2,
				set AHST = AHSTaul*0.91-3.69+AHSTtol,
			endif,
        endif,
    endif,

    if (ComfStand == 6) && (ComfMod == 2),
        if CAT==80,
            if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                set ACST = PMOT*0.30+25.9+ACSTtol,
            elseif PMOT < ACSTall,
                set ACST = 25+ACSTtol,
            elseif PMOT > ACSTaul,
                set ACST = 27+ACSTtol,
            endif,
        elseif CAT==90,
            if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                set ACST = PMOT*0.30+23.6+ACSTtol,
            elseif PMOT < ACSTall,
                set ACST = 24+ACSTtol,
            elseif PMOT > ACSTaul,
                set ACST = 26+ACSTtol,
            endif,
        endif,
    endif,

    if (ComfStand == 6) && (ComfMod == 2),
        if CAT==80,
            if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
                set AHST = PMOT*0.30+25.9+AHSTtol,
            elseif PMOT < AHSTall,
                set AHST = 19+AHSTtol,
            elseif PMOT > AHSTaul,
                set AHST = 22+AHSTtol,
            endif,
        elseif CAT==90,
            if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
                set AHST = PMOT*0.30+23.6+AHSTtol,
            elseif PMOT < AHSTall,
                set AHST = 20+AHSTtol,
            elseif PMOT > AHSTaul,
                set AHST = 23+AHSTtol,
            endif,
        endif,
    endif,


    if (ComfStand == 6) && (ComfMod == 3),
        if CAT == 80,
            if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                set ACST = PMOT*0.30+25.9+ACSTtol,
            elseif (PMOT < ACSTall),
                set ACST = ACSTall*0.30+25.9+ACSTtol,
            elseif (PMOT > ACSTaul),
                set ACST = ACSTaul*0.30+25.9+ACSTtol,
            endif,
        elseif CAT == 90,
            if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                set ACST = PMOT*0.30+23.6+ACSTtol,
            elseif (PMOT < ACSTall),
                set ACST = ACSTall*0.30+23.6+ACSTtol,
            elseif (PMOT > ACSTaul),
                set ACST = ACSTaul*0.30+23.6+ACSTtol,
            endif,
        endif,
    endif,

    if (ComfStand == 6) && (ComfMod == 3),
        if CAT == 80,
            if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
                set AHST = PMOT*0.32+14.88+AHSTtol,
            elseif (PMOT < AHSTall),
                set AHST = AHSTall*0.32+14.88+AHSTtol,
            elseif (PMOT > AHSTaul),
                set AHST = AHSTaul*0.32+14.88+AHSTtol,
            endif,
        elseif CAT == 90,
            if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
                set AHST = PMOT*0.31+17.14+AHSTtol,
            elseif (PMOT < AHSTall),
                set AHST = AHSTall*0.31+17.14+AHSTtol,
            elseif (PMOT > AHSTaul),
                set AHST = AHSTaul*0.31+17.14+AHSTtol,
            endif,
        endif,
    endif,

    if ComfStand == 7 || ComfStand == 8 || ComfStand == 9 || ComfStand == 10,
		if (ComfMod == 0),
	        if CAT==80,
                set ACST = PMOT*0.078+23.25+2.72+ACSTtol,
	        elseif CAT==85,
                set ACST = PMOT*0.078+23.25+2.11+ACSTtol,
	        elseif CAT==90,
                set ACST = PMOT*0.078+23.25+1.5+ACSTtol,
	        endif,
	    endif,
	endif,

	if ComfStand == 7 || ComfStand == 8 || ComfStand == 9 || ComfStand == 10,
		if (ComfMod == 0),
	        if CAT==80,
                set AHST = PMOT*0.078+23.25-2.72+AHSTtol,
	        elseif CAT==85,
                set AHST = PMOT*0.078+23.25-2.11+AHSTtol,
	        elseif CAT==90,
                set AHST = PMOT*0.078+23.25-1.5+AHSTtol,
	        endif,
	    endif,
	endif,

    if (ComfStand == 7) && (ComfMod == 1),
        if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
            set ACST = PMOT*0.54+12.83+ACSToffset+ACSTtol,
        else,
            if CAT==80,
                set ACST = PMOT*0.078+23.25+2.72+ACSTtol,
            elseif CAT==85,
                set ACST = PMOT*0.078+23.25+2.11+ACSTtol,
            elseif CAT==90,
                set ACST = PMOT*0.078+23.25+1.5+ACSTtol,
            endif,
        endif,
    endif,

    if (ComfStand == 7) && (ComfMod == 1),
        if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
            set AHST = PMOT*0.54+12.83+AHSToffset+AHSTtol,
        else,
            if CAT==80,
                set AHST = PMOT*0.078+23.25-2.72+AHSTtol,
            elseif CAT==85,
                set AHST = PMOT*0.078+23.25-2.11+AHSTtol,
            elseif CAT==90,
                set AHST = PMOT*0.078+23.25-1.5+AHSTtol,
            endif,
        endif,
    endif,


	if (ComfStand == 7) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.54+12.83+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==85,
			if PMOT < ACSTall,
				set ACST = 25.72+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27.89+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 7) && (ComfMod == 2),
	    if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
	        set AHST = PMOT*0.54+12.83+AHSToffset+AHSTtol,
	    elseif CAT==80,
	        if PMOT < AHSTall,
	            set AHST = 19+AHSTtol,
	        elseif PMOT > AHSTaul,
	            set AHST = 22+AHSTtol,
	         endif,
	    elseif CAT==85,
	        if PMOT < AHSTall,
	            set AHST = 20.77+AHSTtol,
	         elseif PMOT > AHSTaul,
	            set AHST = 24.26+AHSTtol,
	        endif,
	    elseif CAT==90,
	        if PMOT < AHSTall,
	            set AHST = 20+AHSTtol,
	        elseif PMOT > AHSTaul,
	            set AHST = 23+AHSTtol,
	        endif,
	    endif,
	endif,

	if (ComfStand == 7) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
		    set ACST = PMOT*0.54+12.83+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
		    set ACST = ACSTall*0.54+12.83+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
		    set ACST = ACSTaul*0.54+12.83+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 7) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
		    set AHST = PMOT*0.54+12.83+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
		    set AHST = AHSTall*0.54+12.83+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
		    set AHST = AHSTaul*0.54+12.83+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 8) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.28+17.87+ACSToffset+ACSTtol,
		else,
			if CAT==80,
				set ACST = PMOT*0.078+23.25+2.72+ACSTtol,
			elseif CAT==85,
				set ACST = PMOT*0.078+23.25+2.11+ACSTtol,
			elseif CAT==90,
				set ACST = PMOT*0.078+23.25+1.5+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 8) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.28+17.87+AHSToffset+AHSTtol,
		else,
			if CAT==80,
				set AHST = PMOT*0.078+23.25-2.72+AHSTtol,
			elseif CAT==85,
				set AHST = PMOT*0.078+23.25-2.11+AHSTtol,
			elseif CAT==90,
				set AHST = PMOT*0.078+23.25-1.5+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 8) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
	    	set ACST = PMOT*0.28+17.87+ACSToffset+ACSTtol,
		elseif CAT==80,
	    	if PMOT < ACSTall,
		    	set ACST = 25+ACSTtol,
	    	elseif PMOT > ACSTaul,
		    	set ACST = 27+ACSTtol,
	    	endif,
		elseif CAT==85,
	    	if PMOT < ACSTall,
	    		set ACST = 25.72+ACSTtol,
	    	elseif PMOT > ACSTaul,
	    		set ACST = 27.89+ACSTtol,
	    	endif,
		elseif CAT==90,
	    	if PMOT < ACSTall,
	    		set ACST = 24+ACSTtol,
	    	elseif PMOT > ACSTaul,
	    		set ACST = 26+ACSTtol,
	    	endif,
		endif,
	endif,

	if (ComfStand == 8) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
	    	set AHST = PMOT*0.28+17.87+AHSToffset+AHSTtol,
		elseif CAT==80,
	    	if PMOT < AHSTall,
	    		set AHST = 19+AHSTtol,
	    	elseif PMOT > AHSTaul,
	    		set AHST = 22+AHSTtol,
	    	endif,
		elseif CAT==85,
	    	if PMOT < AHSTall,
	    		set AHST = 20.77+AHSTtol,
	    	elseif PMOT > AHSTaul,
	    		set AHST = 24.26+AHSTtol,
	    	endif,
		elseif CAT==90,
	    	if PMOT < AHSTall,
	    		set AHST = 20+AHSTtol,
	    	elseif PMOT > AHSTaul,
	    		set AHST = 23+AHSTtol,
	    	endif,
		endif,
	endif,

	if (ComfStand == 8) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.28+17.87+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.28+17.87+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.28+17.87+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 8) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.28+17.87+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.28+17.87+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.28+17.87+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 9) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.39+18.42+ACSToffset+ACSTtol,
		else,
			if CAT==80,
				set ACST = PMOT*0.078+23.25+2.72+ACSTtol,
			elseif CAT==90,
				set ACST = PMOT*0.078+23.25+1.5+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 9) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.39+18.42+AHSToffset+AHSTtol,
		else,
			if CAT==80,
				set AHST = PMOT*0.078+23.25+2.72+AHSTtol,
			elseif CAT==90,
				set AHST = PMOT*0.078+23.25+1.5+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 9) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.39+18.42+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 9) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.39+18.42+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 9) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.39+18.42+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.39+18.42+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.39+18.42+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 9) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.39+18.42+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.39+18.42+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.39+18.42+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 10) && (ComfMod == 1),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*0.42+17.6+ACSToffset+ACSTtol,
		else,
			if CAT==80,
				set ACST = RMOT*0.078+23.25+2.72+ACSTtol,
			elseif CAT==90,
				set ACST = RMOT*0.078+23.25+1.5+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 10) && (ComfMod == 1),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*0.42+17.6+AHSToffset+AHSTtol,
		else,
			if CAT==80,
					set AHST = RMOT*0.078+23.25-2.72+AHSTtol,
			elseif CAT==90,
					set AHST = RMOT*0.078+23.25-1.5+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 10) && (ComfMod == 2),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*0.42+17.6+ACSToffset+ACSTtol,
		elseif CAT==80,
			if RMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif RMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if RMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif RMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 10) && (ComfMod == 2),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*0.42+17.6+AHSToffset+AHSTtol,
		elseif CAT==80,
			if RMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif RMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if RMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif RMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 10) && (ComfMod == 3),
		if (RMOT >= ACSTall) && (RMOT <= ACSTaul),
			set ACST = RMOT*0.42+17.6+ACSToffset+ACSTtol,
		elseif RMOT < ACSTall,
			set ACST = ACSTall*0.42+17.6+ACSToffset+ACSTtol,
		elseif RMOT > ACSTaul,
			set ACST = ACSTaul*0.42+17.6+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 10) && (ComfMod == 3),
		if (RMOT >= AHSTall) && (RMOT <= AHSTaul),
			set AHST = RMOT*0.42+17.6+AHSToffset+AHSTtol,
		elseif RMOT < AHSTall,
			set AHST = AHSTall*0.42+17.6+AHSToffset+AHSTtol,
		elseif RMOT > AHSTaul,
			set AHST = AHSTaul*0.42+17.6+AHSToffset+AHSTtol,
		endif,
	endif,


	if (ComfStand == 11) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.75+5.37+ACSToffset+ACSTtol,
		else,
			if CAT==80,
				set ACST = PMOT*0.078+23.25+2.72+ACSTtol,
			elseif CAT==90,
				set ACST = PMOT*0.078+23.25+1.5+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 11) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.75+5.37+AHSToffset+AHSTtol,
		else,
			if CAT==80,
					set AHST = PMOT*0.078+23.25-2.72+AHSTtol,
			elseif CAT==90,
					set AHST = PMOT*0.078+23.25-1.5+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 11) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.75+5.37+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 11) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.75+5.37+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 11) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.75+5.37+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.75+5.37+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.75+5.37+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 11) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.75+5.37+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.75+5.37+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.75+5.37+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 0),
		if (CAT==80),
			set ACST = 27+ACSTtol,
		elseif (CAT==90),
			set ACST = 25.5+ACSTtol,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 0),
		if (CAT==80),
			set AHST = 20+AHSTtol,
		elseif (CAT==90),
			set AHST = 21.5+AHSTtol,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.25+19.7+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 27+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 25.5+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 25.5+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.25+19.7+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 20+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 21.5+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 21.5+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.25+19.7+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.25+19.7+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.25+19.7+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.25+19.7+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.25+19.7+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 12) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.25+19.7+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.25+19.7+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.25+19.7+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 13) || (ComfStand == 14),
        if (CAT==80),
            if (CurrentTime > 6) && (CurrentTime < 23),
                if (ComfMod == 0.1),
                    set ACST = 27+ACSTtol,
                elseif (ComfMod == 0.2),
                    set ACST = 26+ACSTtol,
                elseif (ComfMod == 0.3),
                    set ACST = 25+ACSTtol,
                elseif (ComfMod == 0.4),
                    set ACST = 24+ACSTtol,
                elseif (ComfMod == 0.5),
                    set ACST = 23+ACSTtol,
                endif,
            else,
                set ACST = 24+ACSTtol,
            endif,
        elseif (CAT==90),
            if (CurrentTime > 6) && (CurrentTime < 23),
                if (ComfMod == 0.1),
                    set ACST = 26+ACSTtol,
                elseif (ComfMod == 0.2),
                    set ACST = 25+ACSTtol,
                elseif (ComfMod == 0.3),
                    set ACST = 24+ACSTtol,
                elseif (ComfMod == 0.4),
                    set ACST = 23+ACSTtol,
                elseif (ComfMod == 0.5),
                    set ACST = 22+ACSTtol,
                endif,
            else,
                set ACST = 23+ACSTtol,
            endif,
        endif,
	endif,

	if (ComfStand == 13) || (ComfStand == 14),
		if (ComfMod == 0.1) || (ComfMod == 0.2) || (ComfMod == 0.3) || (ComfMod == 0.4) || (ComfMod == 0.5),
			if (CAT==80),
			    if (CurrentTime >6) && (CurrentTime < 12),
                    set AHST = 20+AHSTtol,
                else,
                    set AHST = 18+AHSTtol,
                endif,
			elseif (CAT==90),
			    if (CurrentTime >6) && (CurrentTime < 12),
                    set AHST = 21+AHSTtol,
                else,
                    set AHST = 19+AHSTtol,
                endif,
			endif,
		endif,
	endif,

	if (ComfStand == 13),
	    if (ComfMod == 1.1) || (ComfMod == 1.2) || (ComfMod == 1.3) || (ComfMod == 1.4) || (ComfMod == 1.5),
	        if CAT == 80,
                if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                    set ACST = PMOT*0.26+15.9+ACSToffset+ACSTtol,
                elseif (PMOT < ACSTall) || (PMOT > ACSTaul),
                    if (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.1),
                        set ACST = 27+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.2),
                            set ACST = 26+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.3),
                            set ACST = 25+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.4),
                            set ACST = 24+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.5),
                            set ACST = 23+ACSTtol,
                    else,
                        set ACST = 24+ACSTtol,
                    endif,
                endif,
            elseif CAT==90,
                if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                    set ACST = PMOT*0.26+15.9+ACSToffset+ACSTtol,
                elseif (PMOT < ACSTall) || (PMOT > ACSTaul),
                    if (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.1),
                        set ACST = 26+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.2),
                            set ACST = 25+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.3),
                            set ACST = 24+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.4),
                            set ACST = 23+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.5),
                            set ACST = 22+ACSTtol,
                    else,
                        set ACST = 23+ACSTtol,
                    endif,
                endif,
            endif,
        endif,
    endif,

	if (ComfStand == 13),
	    if (ComfMod == 1.1) || (ComfMod == 1.2) || (ComfMod == 1.3) || (ComfMod == 1.4) || (ComfMod == 1.5),
	        if CAT == 80,
                if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
                    set AHST = PMOT*0.26+15.9+AHSToffset+AHSTtol,
                elseif (PMOT < AHSTall) || (PMOT > AHSTaul),
                    if (CurrentTime >6) && (CurrentTime < 12),
                        set AHST = 20+AHSTtol,
                    else,
                        set AHST = 18+AHSTtol,
                    endif,
                endif,
            elseif CAT==90,
                if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
                    set AHST = PMOT*0.26+15.9+AHSToffset+AHSTtol,
                elseif (PMOT < AHSTall) || (PMOT > AHSTaul),
                    if (CurrentTime >6) && (CurrentTime < 12),
                        set AHST = 21+AHSTtol,
                    else,
                        set AHST = 19+AHSTtol,
                    endif,
                endif,
            endif,
        endif,
	endif,

	if (ComfStand == 13) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.26+15.9+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 13) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.26+15.9+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 13) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.26+15.9+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.26+15.9+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.26+15.9+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 13) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.26+15.9+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.26+15.9+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.26+15.9+AHSToffset+AHSTtol,
		endif,
	endif,

    if (ComfStand == 14),
	    if (ComfMod == 1.1) || (ComfMod == 1.2) || (ComfMod == 1.3) || (ComfMod == 1.4) || (ComfMod == 1.5),
	        if CAT == 80,
                if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                    set ACST = PMOT*0.26+16.75+ACSToffset+ACSTtol,
                elseif (PMOT < ACSTall) || (PMOT > ACSTaul),
                    if (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.1),
                        set ACST = 27+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.2),
                            set ACST = 26+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.3),
                            set ACST = 25+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.4),
                            set ACST = 24+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.5),
                            set ACST = 23+ACSTtol,
                    else,
                        set ACST = 24+ACSTtol,
                    endif,
                endif,
            elseif CAT==90,
                if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
                    set ACST = PMOT*0.26+16.75+ACSToffset+ACSTtol,
                elseif (PMOT < ACSTall) || (PMOT > ACSTaul),
                    if (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.1),
                        set ACST = 26+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.2),
                            set ACST = 25+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.3),
                            set ACST = 24+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.4),
                            set ACST = 23+ACSTtol,
                    elseif (CurrentTime > 6) && (CurrentTime < 23) && (ComfMod == 1.5),
                            set ACST = 22+ACSTtol,
                    else,
                        set ACST = 23+ACSTtol,
                    endif,
                endif,
            endif,
        endif,
    endif,

	if (ComfStand == 14),
		if (ComfMod == 1.1) || (ComfMod == 1.2) || (ComfMod == 1.3) || (ComfMod == 1.4) || (ComfMod == 1.5),
			if CAT == 80,
				if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
					set AHST = PMOT*0.26+16.75+AHSToffset+AHSTtol,
				elseif (PMOT < AHSTall) || (PMOT > AHSTaul),
					if (CurrentTime >6) && (CurrentTime < 12),
						set AHST = 20+AHSTtol,
					else,
						set AHST = 18+AHSTtol,
					endif,
				endif,
			elseif CAT==90,
				if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
					set AHST = PMOT*0.26+16.75+AHSToffset+AHSTtol,
				elseif (PMOT < AHSTall) || (PMOT > AHSTaul),
					if (CurrentTime >6) && (CurrentTime < 12),
						set AHST = 21+AHSTtol,
					else,
						set AHST = 19+AHSTtol,
					endif,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 14) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.26+16.75+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 14) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.26+16.75+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 14) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.26+16.75+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.26+16.75+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.26+16.75+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 14) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.26+16.75+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.26+16.75+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.26+16.75+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 15) || (ComfStand == 16),
		if (ComfMod == 0),
			if (CAT==80),
				if PMOT < 20,
					set ACST = 23.5+ACSTtol,
					set AHST = 21+ACSTtol,
				else,
					set ACST = 25.5+ACSTtol,
					set AHST = 22.5+ACSTtol,
				endif,
			elseif (CAT==90),
				if PMOT < 20,
					set ACST = 23+ACSTtol,
					set AHST = 21.5+ACSTtol,
				else,
					set ACST = 25+ACSTtol,
					set AHST = 23+ACSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 15) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.56+12.74+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 23.5+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 25.5+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 23+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 15) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.56+12.74+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 21+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22.5+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 23+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 15) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.56+12.74+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 15) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.56+12.74+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 15) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.56+12.74+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.56+12.74+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.56+12.74+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 15) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.56+12.74+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.56+12.74+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.56+12.74+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 16) && (ComfMod == 1),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.09+22.32+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 23.5+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 25.5+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 23+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 16) && (ComfMod == 1),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.09+22.32+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 21+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22.5+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 23+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 16) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.09+22.32+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 16) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.09+22.32+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 16) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.09+22.32+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.09+22.32+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.09+22.32+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 16) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.09+22.32+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.09+22.32+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.09+22.32+AHSToffset+AHSTtol,
		endif,
	endif,


	if (ComfStand == 17) || (ComfStand == 18) || (ComfStand == 19) || (ComfStand == 20),
		if ComfMod == 0,
			set ACST = 25+ACSTtol,
			set AHST = 20+AHSTtol,
		endif,
	endif,

	if (ComfStand == 17) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.48+13.9+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.59+9.6+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 17) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.48+13.9+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.59+9.6+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 17) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.48+13.9+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.59+9.6+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 17) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.48+13.9+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.59+9.6+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 17) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.48+13.9+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.48+13.9+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.48+13.9+ACSToffset+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.59+9.6+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.59+9.6+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.59+9.6+ACSToffset+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 17) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.48+13.9+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.48+13.9+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.48+13.9+AHSToffset+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.59+9.6+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.59+9.6+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.59+9.6+AHSToffset+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 18) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.84+5.3+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.96-3.6+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 18) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.84+5.3+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.96-3.6+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 18) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.84+5.3+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.96-3.6+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 18) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.84+5.3+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.96-3.6+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 18) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.84+5.3+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.84+5.3+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.84+5.3+ACSToffset+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.96-3.6+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.96-3.6+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.96-3.6+ACSToffset+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 18) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.84+5.3+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.84+5.3+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.84+5.3+AHSToffset+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.96-3.6+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.96-3.6+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.96-3.6+AHSToffset+AHSTtol,
			endif,
		endif,
	endif,







	if (ComfStand == 19) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.27+17.9+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.53+10.3+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 19) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.27+17.9+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.53+10.3+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 19) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.27+17.9+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.53+10.3+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 19) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.27+17.9+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.53+10.3+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 19) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.27+17.9+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.27+17.9+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.27+17.9+ACSToffset+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.53+10.3+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.53+10.3+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.53+10.3+ACSToffset+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 19) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.27+17.9+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.27+17.9+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.27+17.9+AHSToffset+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.53+10.3+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.53+10.3+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.53+10.3+AHSToffset+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 20) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.38+15.7+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.47+9.07+ACSToffset+ACSTtol,
			else,
				set ACST = 25+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 20) && (ComfMod == 1),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.38+15.7+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.47+9.07+AHSToffset+AHSTtol,
			else,
				set AHST = 20+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 20) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.38+15.7+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.47+9.07+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				if CAT == 90,
					set ACST = 24+ACSTtol,
				elseif CAT == 80,
					set ACST = 25+ACSTtol,
				endif,
			elseif PMOT > ACSTaul,
				if CAT == 90,
					set ACST = 26+ACSTtol,
				elseif CAT == 80,
					set ACST = 27+ACSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 20) && (ComfMod == 2),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.38+15.7+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.47+9.07+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				if CAT == 90,
					set AHST = 20+AHSTtol,
				elseif CAT == 80,
					set AHST = 19+AHSTtol,
				endif,
			elseif PMOT > AHSTaul,
				if CAT == 90,
					set AHST = 23+AHSTtol,
				elseif CAT == 80,
					set AHST = 22+AHSTtol,
				endif,
			endif,
		endif,
	endif,

	if (ComfStand == 20) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.38+15.7+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.38+15.7+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.38+15.7+ACSToffset+ACSTtol,
			endif,
		else,
			if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
				set ACST = PMOT*0.47+9.07+ACSToffset+ACSTtol,
			elseif PMOT < ACSTall,
				set ACST = ACSTall*0.47+9.07+ACSToffset+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = ACSTaul*0.47+9.07+ACSToffset+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 20) && (ComfMod == 3),
		if (DayOfYear <= 121) || (DayOfYear > 295),
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.38+15.7+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.38+15.7+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.38+15.7+AHSToffset+AHSTtol,
			endif,
		else,
			if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
				set AHST = PMOT*0.47+9.07+AHSToffset+AHSTtol,
			elseif PMOT < AHSTall,
				set AHST = AHSTall*0.47+9.07+AHSToffset+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = AHSTaul*0.47+9.07+AHSToffset+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 21) && (ComfMod == 2),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.678+13.51+ACSToffset+ACSTtol,
		elseif CAT==80,
			if PMOT < ACSTall,
				set ACST = 25+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 27+ACSTtol,
			endif,
		elseif CAT==90,
			if PMOT < ACSTall,
				set ACST = 24+ACSTtol,
			elseif PMOT > ACSTaul,
				set ACST = 26+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 21) && (ComfMod == 2),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.678+13.51+AHSToffset+AHSTtol,
		elseif CAT==80,
			if PMOT < AHSTall,
				set AHST = 19+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 22+AHSTtol,
			endif,
		elseif CAT==90,
			if PMOT < AHSTall,
				set AHST = 20+AHSTtol,
			elseif PMOT > AHSTaul,
				set AHST = 23+AHSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 21) && (ComfMod == 3),
		if (PMOT >= ACSTall) && (PMOT <= ACSTaul),
			set ACST = PMOT*0.678+13.51+ACSToffset+ACSTtol,
		elseif PMOT < ACSTall,
			set ACST = ACSTall*0.678+13.51+ACSToffset+ACSTtol,
		elseif PMOT > ACSTaul,
			set ACST = ACSTaul*0.678+13.51+ACSToffset+ACSTtol,
		endif,
	endif,

	if (ComfStand == 21) && (ComfMod == 3),
		if (PMOT >= AHSTall) && (PMOT <= AHSTaul),
			set AHST = PMOT*0.678+13.51+AHSToffset+AHSTtol,
		elseif PMOT < AHSTall,
			set AHST = AHSTall*0.678+13.51+AHSToffset+AHSTtol,
		elseif PMOT > AHSTaul,
			set AHST = AHSTaul*0.678+13.51+AHSToffset+AHSTtol,
		endif,
	endif,

	if (ComfStand == 22),
		if CoolingSeason == 1,
			if (CAT==3),
				set ACST = 24.5+2.5+ACSTtol,
			elseif (CAT==2),
				set ACST = 24.5+1.5+ACSTtol,
			elseif (CAT==1),
				set ACST = 24.5+1+ACSTtol,
			endif,
		else,
			if (CAT==3),
				set ACST = 22+3+ACSTtol,
			elseif (CAT==2),
				set ACST = 22+2+ACSTtol,
			elseif (CAT==1),
				set ACST = 22+1+ACSTtol,
			endif,
		endif,
	endif,

	if (ComfStand == 22),
		if CoolingSeason == 1,
			if (CAT==3),
				set AHST = 24.5-2.5+AHSTtol,
			elseif (CAT==2),
				set AHST = 24.5-1.5+AHSTtol,
			elseif (CAT==1),
				set AHST = 24.5-1+AHSTtol,
			endif,
		else,
			if (CAT==3),
				set AHST = 22-3+AHSTtol,
			elseif (CAT==2),
				set AHST = 22-2+AHSTtol,
			elseif (CAT==1),
				set AHST = 22-1+AHSTtol,
			endif,
		endif,
	endif,


	set ACSTx2 = ACST*SetpointAcc,
    set AHSTx2 = AHST*SetpointAcc,

    set roundedACSTx2 = @Round ACSTx2,
    set roundedAHSTx2 = @Round AHSTx2,

    if roundedACSTx2 - ACSTx2 < 0,
        set ACSTroundedUp = 0,
    else,
        set ACSTroundedUp = 1,
    endif,

    if roundedAHSTx2 - AHSTx2 < 0,
        set AHSTroundedUp = 0,
    else,
        set AHSTroundedUp = 1,
    endif,

    if ACSTroundedUp == 0,
        set roundedACST = roundedACSTx2 / SetpointAcc,
    else,
        set roundedACST = (roundedACSTx2 - 1) / SetpointAcc,
    endif,

    if AHSTroundedUp == 0,
        set roundedAHST = (roundedAHSTx2 + 1) / SetpointAcc,
    else,
        set roundedAHST = roundedAHSTx2 / SetpointAcc,
    endif;





EnergyManagementSystem:ProgramCallingManager,
SetASTnoTol,
    BeginTimestepBeforePredictor,
    SetASTnoTol;

    EnergyManagementSystem:Program,
    SetASTnoTol,
    set ACSTnoTol = ACST-ACSTtol,
    set AHSTnoTol = AHST-AHSTtol;


!ACTUATORS
<ForAllOccupiedZones>
EnergyManagementSystem:Actuator,
ACST_Act_<LoopZoneVariableName>,
    ACST_Sch_<LoopZoneVariableName>,
    Schedule:Compact,
    Schedule Value;

EnergyManagementSystem:Actuator,
AHST_Act_<LoopZoneVariableName>,
    AHST_Sch_<LoopZoneVariableName>,
    Schedule:Compact,
    Schedule Value;
<LoopNextZone>


<ForAllExternalWindows>
EnergyManagementSystem:Actuator,
<LoopWindowVariableName>_VentOpenFact,
 <LoopWindowIDFName>,
 AirFlow Network Window/Door Opening,
 Venting Opening Factor;
<LoopNextWindow>

!Programa: Aplicacion de la consigna de ventilacion

EnergyManagementSystem:ProgramCallingManager,
SetVOFinputData,
    BeginTimestepBeforePredictor,
    SetVOFinputData;

    EnergyManagementSystem:Program,
    SetVOFinputData,
	set MaxTempDiffVOF = 10,
	set MinTempDiffVOF = 0,
	set MultiplierVOF = 0.25;

EnergyManagementSystem:ProgramCallingManager,
SetMyVOF,
    BeginTimestepBeforePredictor,
    SetMyVOF;

    EnergyManagementSystem:Program,
    SetMyVOF,
    <ForAllExternalWindows>

	set slope = (1 - MultiplierVOF) / (MinTempDiffVOF - MaxTempDiffVOF),

	if <LoopWindowVariableName>_OutT > 0,
		set <LoopWindowVariableName>_TempDiffVOF = <LoopWindowVariableName>_OpT - <LoopWindowVariableName>_OutT,
	else,
		set <LoopWindowVariableName>_TempDiffVOF = <LoopWindowVariableName>_OpT + <LoopWindowVariableName>_OutT,
	endif,

	if <LoopWindowVariableName>_OutT > <LoopWindowVariableName>_OpT,
		set <LoopWindowVariableName>_MyVOF = 0,
	else,
		if <LoopWindowVariableName>_TempDiffVOF > MaxTempDiffVOF,
		  set <LoopWindowVariableName>_MyVOF = MultiplierVOF,
		elseif <LoopWindowVariableName>_TempDiffVOF < MinTempDiffVOF,
		  set <LoopWindowVariableName>_MyVOF = 1.0,
		else,
		  set <LoopWindowVariableName>_MyVOF = slope*<LoopWindowVariableName>_TempDiffVOF - slope*MinTempDiffVOF + 1,
		endif,
	endif,
	<LoopNextWindow>;


EnergyManagementSystem:ProgramCallingManager,
SetVST,
    BeginTimestepBeforePredictor,
    SetVST;

    EnergyManagementSystem:Program,
    SetVST,
	set MinOutTemp = roundedAHST - MinOToffset,
    if (VentCtrl == 0) || (VentCtrl==2),
        if ComfStand == 0,
            if (CurrentTime < 7),
                set VST = (roundedACST+roundedAHST)/2+VSToffset,
            elseif (CurrentTime < 15),
                set VST = 22.5+VSToffset,
            elseif (CurrentTime < 23),
                set VST = (roundedACST+roundedAHST)/2+VSToffset,
            elseif (CurrentTime < 24),
                set VST = (roundedACST+roundedAHST)/2+VSToffset,
            endif,
        elseif ComfStand == 1 || ComfStand == 10,
            if (RMOT >= AHSTall) && (RMOT <= ACSTaul),
                set VST = ComfTemp+VSToffset,
            else,
                set VST = (roundedACST+roundedAHST)/2+VSToffset,
            endif,
        elseif ComfStand == 4 || ComfStand == 5 || ComfStand == 6,
            if (PMOT >= AHSTall) && (PMOT <= ACSTaul),
                set VST = (roundedACST+roundedAHST)/2+VSToffset,
            else,
                set VST = 0,
            endif,
        else,
            if (PMOT >= AHSTall) && (PMOT <= ACSTaul),
                set VST = ComfTemp+VSToffset,
            else,
                set VST = (roundedACST+roundedAHST)/2+VSToffset,
            endif,
        endif,
    elseif (VentCtrl == 1) || (VentCtrl==3),
        set VST = roundedAHST+VSToffset,
    endif;

!Programa: Aplicacion de las temperaturas de consigna



EnergyManagementSystem:ProgramCallingManager,
ApplyAST_MixedMode,
    BeginTimestepBeforePredictor,
    ApplyAST_MixedMode;

	EnergyManagementSystem:Program,
	ApplyAST_MixedMode,
	<ForAllOccupiedZones>
	if <LoopZoneVariableName>_CoolCoil==0,
		if <LoopZoneVariableName>_HeatCoil==0,
			set NoH_NoC_reqs = 1,
		else,
			set NoH_NoC_reqs = 0,
		endif,
	else,
		set NoH_NoC_reqs = 0,
	endif,

    if <LoopZoneVariableName>_OpT<roundedACST,
        if <LoopZoneVariableName>_WindSpeed <= MaxWindSpeed,
            if <LoopZoneVariableName>_OutT>MinOutTemp,
                if <LoopZoneVariableName>_OutT < <LoopZoneVariableName>_OpT,
                    set meets_base_reqs = 1,
                else,
                    set meets_base_reqs = 0,
                endif,
            else,
                set meets_base_reqs = 0,
            endif,
        else,
            set meets_base_reqs = 0,
        endif,
    else,
        set meets_base_reqs = 0,
    endif,

    if (NoH_NoC_reqs == 1) && (meets_base_reqs == 1),
        if <LoopZoneVariableName>_OpT>VST,
            set Ventilates_HVACmode2_<LoopZoneVariableName> = 1,
        else,
            set Ventilates_HVACmode2_<LoopZoneVariableName> = 0,
        endif,
    else,
        set Ventilates_HVACmode2_<LoopZoneVariableName> = 0,
    endif,

	if VentCtrl == 0,
		if <LoopZoneVariableName>_OutT < <LoopZoneVariableName>_OpT,
			if <LoopZoneVariableName>_OutT>MinOutTemp,
				if <LoopZoneVariableName>_OpT > VST,
					if <LoopZoneVariableName>_WindSpeed <= MaxWindSpeed,
						set Ventilates_HVACmode1_<LoopZoneVariableName> = 1,
					else,
						set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
					endif,
				else,
					set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
				endif,
			else,
				set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
			endif,
		else,
			set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
		endif,
	elseif VentCtrl == 1,
		if <LoopZoneVariableName>_OutT<<LoopZoneVariableName>_OpT,
			if <LoopZoneVariableName>_OutT>MinOutTemp,
				if <LoopZoneVariableName>_OpT > ACSTnoTol,
					if <LoopZoneVariableName>_WindSpeed <= MaxWindSpeed,
						set Ventilates_HVACmode1_<LoopZoneVariableName> = 1,
					else,
						set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
					endif,
				else,
					set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
				endif,
			else,
				set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
			endif,
		else,
			set Ventilates_HVACmode1_<LoopZoneVariableName> = 0,
		endif,
	endif,

	if HVACmode == 0,
	    if Occ_count_<LoopZoneVariableName> == 0,
            Set ACST_Act_<LoopZoneVariableName> = 100,
		    Set AHST_Act_<LoopZoneVariableName> = -100,
		else,
            set ACST_Act_<LoopZoneVariableName> = roundedACST,
            set AHST_Act_<LoopZoneVariableName> = roundedAHST,
        endif,
	elseif HVACmode == 1,
		Set ACST_Act_<LoopZoneVariableName> = 100,
		Set AHST_Act_<LoopZoneVariableName> = -100,
        if Ventilates_HVACmode1_<LoopZoneVariableName> == 1 && Occ_count_<LoopZoneVariableName> > 0,
            set VentHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
        else,
            set VentHours_<LoopZoneVariableName> = 0,
        endif,
	elseif HVACmode == 2,
	    if Occ_count_<LoopZoneVariableName> == 0,
            Set ACST_Act_<LoopZoneVariableName> = 100,
		    Set AHST_Act_<LoopZoneVariableName> = -100,
		    set VentHours_<LoopZoneVariableName> = 0,
        else,
            if Ventilates_HVACmode2_<LoopZoneVariableName> == 1,
                set VentHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
            elseif Ventilates_HVACmode2_<LoopZoneVariableName> == 0,
                set VentHours_<LoopZoneVariableName> = 0,
                set ACST_Act_<LoopZoneVariableName> = roundedACST,
                set AHST_Act_<LoopZoneVariableName> = roundedAHST,
            endif,
        endif,
	endif,
	<LoopNextZone>;


	EnergyManagementSystem:ProgramCallingManager,
	SetWindowOperation,
	    BeginTimestepBeforePredictor,
	    SetWindowOperation;

		EnergyManagementSystem:Program,
		SetWindowOperation,
		<ForAllExternalWindows>

        if <LoopWindowVariableName>_CoolCoil==0,
            if <LoopWindowVariableName>_HeatCoil==0,
                set NoH_NoC_reqs = 1,
            else,
                set NoH_NoC_reqs = 0,
            endif,
        else,
            set NoH_NoC_reqs = 0,
        endif,

        if <LoopWindowVariableName>_OpT<roundedACST,
            if <LoopWindowVariableName>_WindSpeed <= MaxWindSpeed,
                if <LoopWindowVariableName>_OutT>MinOutTemp,
                    if <LoopWindowVariableName>_OutT < <LoopWindowVariableName>_OpT,
                        if <LoopWindowVariableName>_Occ_count > 0,
                            set meets_base_reqs = 1,
                        else,
                            set meets_base_reqs = 0,
                        endif,
                    else,
                        set meets_base_reqs = 0,
                    endif,
                else,
                    set meets_base_reqs = 0,
                endif,
            else,
                set meets_base_reqs = 0,
            endif,
        else,
            set meets_base_reqs = 0,
        endif,

        if (NoH_NoC_reqs == 1) && (meets_base_reqs == 1),
            if <LoopWindowVariableName>_OpT>VST,
                set Ventilates_HVACmode2_<LoopWindowVariableName> = 1,
            else,
                set Ventilates_HVACmode2_<LoopWindowVariableName> = 0,
            endif,
        else,
            set Ventilates_HVACmode2_<LoopWindowVariableName> = 0,
        endif,

		if VentCtrl == 0,
			if <LoopWindowVariableName>_OutT < <LoopWindowVariableName>_OpT,
				if <LoopWindowVariableName>_OutT>MinOutTemp,
					if <LoopWindowVariableName>_OpT > VST,
						if <LoopWindowVariableName>_WindSpeed <= MaxWindSpeed,
							set Ventilates_HVACmode1_<LoopWindowVariableName> = 1,
						else,
							set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
						endif,
					else,
						set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
					endif,
				else,
					set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
				endif,
			else,
				set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
			endif,
		elseif VentCtrl == 1,
			if <LoopWindowVariableName>_OutT<<LoopWindowVariableName>_OpT,
				if <LoopWindowVariableName>_OutT>MinOutTemp,
					if <LoopWindowVariableName>_OpT > ACSTnoTol,
						if <LoopWindowVariableName>_WindSpeed <= MaxWindSpeed,
							set Ventilates_HVACmode1_<LoopWindowVariableName> = 1,
						else,
							set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
						endif,
					else,
						set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
					endif,
				else,
					set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
				endif,
			else,
				set Ventilates_HVACmode1_<LoopWindowVariableName> = 0,
			endif,
		endif,

		if HVACmode == 0,
			set <LoopWindowVariableName>_VentOpenFact = 0,
		elseif HVACmode == 1,
			if Ventilates_HVACmode1_<LoopWindowVariableName> == 1,
				set <LoopWindowVariableName>_VentOpenFact = <LoopWindowVariableName>_MyVOF,
			else,
				set <LoopWindowVariableName>_VentOpenFact = 0,
			endif,
		elseif HVACmode == 2,
			if Ventilates_HVACmode2_<LoopWindowVariableName> == 1,
			    if (VentCtrl==0) || (VentCtrl==1),
                    set <LoopWindowVariableName>_VentOpenFact = 1,
                elseif (VentCtrl==2) || (VentCtrl==3),
                    set <LoopWindowVariableName>_VentOpenFact = <LoopWindowVariableName>_MyVOF,
                endif,
			else,
				set <LoopWindowVariableName>_VentOpenFact = 0,
			endif,
		endif,
	<LoopNextWindow>;

EnergyManagementSystem:ProgramCallingManager,
CountHoursNoApp,
    BeginTimestepBeforePredictor,
    CountHoursNoApp;

	EnergyManagementSystem:Program,
    CountHoursNoApp,
	<ForAllOccupiedZones>

	if (<LoopZoneVariableName>_OpT <= ACSTnoTol),
		if (<LoopZoneVariableName>_OpT >= AHSTnoTol),
			set ComfHoursNoApp_<LoopZoneVariableName> = 1*ZoneTimeStep,
			if Occ_count_<LoopZoneVariableName>,
			    set OccComfHoursNoApp_<LoopZoneVariableName> = 1*ZoneTimeStep,
            else,
                set OccComfHoursNoApp_<LoopZoneVariableName> = 0,
            endif,
		else,
			set ComfHoursNoApp_<LoopZoneVariableName> = 0,
		endif,
	else,
		set ComfHoursNoApp_<LoopZoneVariableName> = 0,
	endif,

    if Occ_count_<LoopZoneVariableName> > 0,
	    set OccHours_<LoopZoneVariableName> = 1*ZoneTimeStep,
    else,
        set OccHours_<LoopZoneVariableName> = 0,
    endif,

	<LoopNextZone>;

!Normalise energy demand per area units

!Internal Variables

<ForAllOccupiedZones>
EnergyManagementSystem:InternalVariable,
ZFA_<LoopZoneVariableName>,
    <LoopZoneIDFName>,
    Zone Floor Area;
EnergyManagementSystem:InternalVariable,
    ZAV_<LoopZoneVariableName>,
    <LoopZoneIDFName>,
    Zone Air Volume;
<LoopNextZone>

!Program
EnergyManagementSystem:ProgramCallingManager,
SetGeoVar,
	!EndOfZoneTimestepBeforeZoneReporting,
	EndOfSystemTimestepAfterHVACReporting,
    SetGeoVar;

	EnergyManagementSystem:Program,
	SetGeoVar,
	<ForAllOccupiedZones>
	set ZoneFloorArea_<LoopZoneVariableName> = ZFA_<LoopZoneVariableName>/2,
	set ZoneAirVolume_<LoopZoneVariableName> = ZAV_<LoopZoneVariableName>/2,
	<LoopNextZone>;

EnergyManagementSystem:ProgramCallingManager,
NormEnerDem,
	!EndOfZoneTimestepBeforeZoneReporting,
	EndOfSystemTimestepAfterHVACReporting,
    NormEnerDem;

	EnergyManagementSystem:Program,
	NormEnerDem,
	<ForAllOccupiedZones>
	set NormHeatDem_<LoopZoneVariableName> = <LoopZoneVariableName>_HeatCoil / ZoneFloorArea_<LoopZoneVariableName>,
	set NormCoolDem_<LoopZoneVariableName> = <LoopZoneVariableName>_CoolCoil / ZoneFloorArea_<LoopZoneVariableName>,
	<LoopNextZone>;

EnergyManagementSystem:ProgramCallingManager,
NormEnerCon,
	!EndOfZoneTimestepBeforeZoneReporting,
	EndOfSystemTimestepAfterHVACReporting,
    NormEnerCon;

	EnergyManagementSystem:Program,
	NormEnerCon,
	<ForAllOccupiedZones>
	set NormHeatCon = VRF_CoolCon_<LoopZoneVariableName> / ZoneFloorArea_<LoopZoneVariableName>,
	set NormCoolCon = VRF_HeatCon_<LoopZoneVariableName> / ZoneFloorArea_<LoopZoneVariableName>,
	<LoopNextZone>;

<ForAllOccupiedZones>
EnergyManagementSystem:Sensor,
VRF_CoolCon_<LoopZoneVariableName>,
    VRF Outdoor Unit_<LoopZoneVariableName>,
    VRF Heat Pump Cooling Electric Energy;

EnergyManagementSystem:Sensor,
VRF_HeatCon_<LoopZoneVariableName>,
    VRF Outdoor Unit_<LoopZoneVariableName>,
    VRF Heat Pump Heating Electric Energy;

EnergyManagementSystem:Sensor,
VRF_CoolRate_<LoopZoneVariableName>,
    VRF Outdoor Unit_<LoopZoneVariableName>,
    VRF Heat Pump Total Cooling Rate;

EnergyManagementSystem:Sensor,
VRF_HeatRate_<LoopZoneVariableName>,
    VRF Outdoor Unit_<LoopZoneVariableName>,
    VRF Heat Pump Total Heating Rate;

Output:Variable, VRF_CoolCon_<LoopZoneVariableName>, VRF Heat Pump Cooling Electric Energy, Hourly;
Output:Variable, VRF_HeatCon_<LoopZoneVariableName>, VRF Heat Pump Heating Electric Energy, Hourly;
Output:Variable, VRF_CoolRate_<LoopZoneVariableName>, VRF Heat Pump Total Cooling Rate, Hourly;
Output:Variable, VRF_HeatRate_<LoopZoneVariableName>, VRF Heat Pump Total Heating Rate, Hourly;
<LoopNextZone>






EnergyManagementSystem:OutputVariable,
Comfort Temperature,
	ComfTemp,
	Averaged,
	ZoneTimestep,
	,
	C;

EnergyManagementSystem:OutputVariable,
Adaptive Cooling Setpoint Temperature,
	roundedACST,
	Averaged,
	ZoneTimestep,
	,
	C;

EnergyManagementSystem:OutputVariable,
Adaptive Heating Setpoint Temperature,
	roundedAHST,
	Averaged,
	ZoneTimestep,
	,
	C;

EnergyManagementSystem:OutputVariable,
Adaptive Cooling Setpoint Temperature_No Tolerance,
	ACSTnoTol,
	Averaged,
	ZoneTimestep,
	,
	C;

EnergyManagementSystem:OutputVariable,
Adaptive Heating Setpoint Temperature_No Tolerance,
	AHSTnoTol,
	Averaged,
	ZoneTimestep,
	,
	C;

<ForAllOccupiedZones>
EnergyManagementSystem:OutputVariable,
Comfortable Hours_No Applicability_<LoopZoneVariableName> (summed),
	ComfHoursNoApp_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Occupied Comfortable Hours_No Applicability_<LoopZoneVariableName> (summed),
	OccComfHoursNoApp_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Occupied Hours_<LoopZoneVariableName> (summed),
	OccHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Comfortable Hours_<LoopZoneVariableName> (summed),
	ComfHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Discomfortable Applicable Hot Hours_<LoopZoneVariableName> (summed),
	DiscomfAppHotHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Discomfortable Applicable Cold Hours_<LoopZoneVariableName> (summed),
	DiscomfAppColdHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Discomfortable Non Applicable Hot Hours_<LoopZoneVariableName> (summed),
	DiscomfNonAppHotHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Discomfortable Non Applicable Cold Hours_<LoopZoneVariableName> (summed),
	DiscomfNonAppColdHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Ventilation Hours_<LoopZoneVariableName> (summed),
	VentHours_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	h;

EnergyManagementSystem:OutputVariable,
Normalised Heating Demand_<LoopZoneVariableName>,
	NormHeatDem_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	W;

EnergyManagementSystem:OutputVariable,
Normalised Cooling Demand_<LoopZoneVariableName>,
	NormCoolDem_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	W;

EnergyManagementSystem:OutputVariable,
Normalised Heating Consumption_<LoopZoneVariableName>,
	NormHeatCon_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	W;

EnergyManagementSystem:OutputVariable,
Normalised Cooling Consumption_<LoopZoneVariableName>,
	NormCoolCon_<LoopZoneVariableName>,
	Summed,
	ZoneTimestep,
	,
	W;

EnergyManagementSystem:OutputVariable,
Zone Floor Area_<LoopZoneVariableName>,
	ZoneFloorArea_<LoopZoneVariableName>,
	Averaged,
	ZoneTimestep,
	,
	m2;

EnergyManagementSystem:OutputVariable,
Zone Air Volume_<LoopZoneVariableName>,
	ZoneAirVolume_<LoopZoneVariableName>,
	Averaged,
	ZoneTimestep,
	,
	m3;
<LoopNextZone>


EnergyManagementSystem:OutputVariable,
Ventilation Setpoint Temperature,
	VST,
	Averaged,
	ZoneTimestep,
	,
	C;

EnergyManagementSystem:OutputVariable,
Minimum Outdoor Temperature for mixed mode ventilation,
	MinOutTemp,
	Averaged,
	ZoneTimestep,
	,
	C;

Output:Variable, *, Zone Thermostat Operative Temperature, Hourly;
Output:Variable, *, Adaptive Cooling Setpoint Temperature, Hourly;
Output:Variable, *, Adaptive Heating Setpoint Temperature, Hourly;
Output:Variable, *, Adaptive Cooling Setpoint Temperature_No Tolerance, Hourly;
Output:Variable, *, Adaptive Heating Setpoint Temperature_No Tolerance, Hourly;
Output:Variable, *, Comfort Temperature, Hourly;
Output:Variable, *, Ventilation Setpoint Temperature, Hourly;
Output:Variable, *, Minimum Outdoor Temperature for mixed mode ventilation, Hourly;
Output:Variable, Environment, Site Outdoor Air Drybulb Temperature, Hourly;
Output:Variable, *, Zone Thermal Comfort CEN 15251 Adaptive Model Running Average Outdoor Air Temperature, Hourly;
Output:Variable, *, Zone Operative Temperature, Hourly;
<ForAllOccupiedZones>
Output:Variable, *, Comfortable Hours_No Applicability_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, *, Comfortable Hours_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, *, Discomfortable Applicable Hot Hours_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, *, Discomfortable Applicable Cold Hours_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, *, Discomfortable Non Applicable Hot Hours_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, *, Discomfortable Non Applicable Cold Hours_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, *, Ventilation Hours_<LoopZoneVariableName> (summed), Hourly;
Output:Variable, <LoopZoneIDFName>, Zone Operative Temperature, Hourly;
Output:Variable, AHST_Sch_<LoopZoneVariableName>, Schedule Value, Hourly;
Output:Variable, ACST_Sch_<LoopZoneVariableName>, Schedule Value, Hourly;
Output:Variable, Ventilation Hours_<LoopZoneVariableName> (summed), Schedule Value, Hourly;
Output:Variable, *,Normalised Heating Demand_<LoopZoneVariableName>, Hourly;
Output:Variable, *,Normalised Cooling Demand_<LoopZoneVariableName>, Hourly;
Output:Variable, *,Normalised Heating Consumption_<LoopZoneVariableName>, Hourly;
Output:Variable, *,Normalised Cooling Consumption_<LoopZoneVariableName>, Hourly;
Output:Variable, *,Zone Floor Area_<LoopZoneVariableName>, Hourly;
Output:Variable, *,Zone Air Volume_<LoopZoneVariableName>, Hourly;
<LoopNextZone>
Output:Variable, *, AFN Surface Venting Window or Door Opening Factor, Hourly;
Output:Variable, *, AFN Zone Infiltration Air Change Rate, Hourly;
Output:Variable, *, AFN Zone Infiltration Volume, Hourly;
Output:Variable, *, VRF Heat Pump Cooling Electric Energy, Hourly;
Output:Variable, *, VRF Heat Pump Heating Electric Energy, Hourly;
Output:Variable, *, Cooling Coil Total Cooling Rate, Hourly;
Output:Variable, *, Heating Coil Heating Rate, Hourly;
<ForAllExternalWindows>
Output:Variable,<LoopWindowZoneIDFName> VRF Indoor Unit DX Cooling Coil,Cooling Coil Total Cooling Rate, Hourly;
Output:Variable,<LoopWindowZoneIDFName> VRF Indoor Unit DX Heating Coil,Heating Coil Heating Rate, Hourly;
Output:Variable, <LoopWindowZoneIDFName>, Zone Outdoor Air Wind Speed, Hourly;
Output:Variable, <LoopWindowZoneIDFName>, Zone Outdoor Air Drybulb Temperature, Hourly;
<LoopNextWindow>

!Output:Variable,*,Normalised Cooling Demand_BLOCK1_ZONE1, Hourly;
!Output:Variable,*,Normalised Cooling Demand_BLOCK1_ZONE2, Hourly;
!Output:Variable,*,Normalised Heating Demand_BLOCK1_ZONE1, Hourly;
!Output:Variable,*,Normalised Heating Demand_BLOCK1_ZONE2, Hourly;

!Facility Total HVAC Electric Demand Power = Cooling (Electricity) + Heating (Electricity) + Auxiliary Energy + System pumps + System fans
!Facility total electric demand power = Facility Total HVAC Electric Demand Power + Facility Total Building Electric Demand Power
Output:Variable, *, Facility Total HVAC Electric Demand Power, Hourly;

! WIP: SCHEDULE VALUES


!Frecuencias de las Output:Variables

Output:Variable, *, Zone Thermostat Operative Temperature, Timestep;
Output:Variable, *, Adaptive Cooling Setpoint Temperature, Timestep;
Output:Variable, *, Adaptive Heating Setpoint Temperature, Timestep;
Output:Variable, *, Adaptive Cooling Setpoint Temperature_No Tolerance, Timestep;
Output:Variable, *, Adaptive Heating Setpoint Temperature_No Tolerance, Timestep;
Output:Variable, *, Comfort Temperature, Timestep;
Output:Variable, *, Ventilation Setpoint Temperature, Timestep;
Output:Variable, *, Minimum Outdoor Temperature for mixed mode ventilation, Timestep;
Output:Variable, Environment, Site Outdoor Air Drybulb Temperature, Timestep;
Output:Variable, *, Zone Thermal Comfort CEN 15251 Adaptive Model Running Average Outdoor Air Temperature, Timestep;
Output:Variable, *, Zone Operative Temperature, Timestep;
<ForAllOccupiedZones>
Output:Variable, *, Comfortable Hours_No Applicability_<LoopZoneVariableName> (summed), Timestep;
Output:Variable, *, Comfortable Hours_<LoopZoneVariableName> (summed), Timestep;
Output:Variable, *, Discomfortable Applicable Hot Hours_<LoopZoneVariableName> (summed), Timestep;
Output:Variable, *, Discomfortable Applicable Cold Hours_<LoopZoneVariableName> (summed), Timestep;
Output:Variable, *, Discomfortable Non Applicable Hot Hours_<LoopZoneVariableName> (summed), Timestep;
Output:Variable, *, Discomfortable Non Applicable Cold Hours_<LoopZoneVariableName> (summed), Timestep;
Output:Variable, <LoopZoneIDFName>, Zone Operative Temperature, Timestep;
Output:Variable, AHST_Sch_<LoopZoneVariableName>, Schedule Value, Timestep;
Output:Variable, ACST_Sch_<LoopZoneVariableName>, Schedule Value, Timestep;
Output:Variable, Ventilation Hours_<LoopZoneVariableName> (summed), Schedule Value, Timestep;
Output:Variable, Normalised Heating Demand_<LoopZoneVariableName>, Timestep;
Output:Variable, Normalised Cooling Demand_<LoopZoneVariableName>, Timestep;
<LoopNextZone>
Output:Variable, *, AFN Surface Venting Window or Door Opening Factor, Timestep;
Output:Variable, *, AFN Zone Infiltration Air Change Rate, Timestep;
Output:Variable, *, AFN Zone Infiltration Volume, Timestep;
!Output:Variable, *, VRF Heat Pump Cooling Electric Energy, Timestep;
!Output:Variable, *, VRF Heat Pump Heating Electric Energy, Timestep;
Output:Variable, *, Cooling Coil Total Cooling Rate, Timestep;
Output:Variable, *, Heating Coil Heating Rate, Timestep;
<ForAllExternalWindows>
Output:Variable,<LoopWindowZoneIDFName> Cooled Beam,Zone Air Terminal Beam Chilled Water Energy, Timestep;
Output:Variable,<LoopWindowZoneIDFName> Electric Convector,Baseboard Total Heating Energy, Timestep;
Output:Variable, <LoopWindowZoneIDFName>, Zone Outdoor Air Wind Speed, Timestep;
Output:Variable, <LoopWindowZoneIDFName>, Zone Outdoor Air Drybulb Temperature, Timestep;
<LoopNextWindow>

!Facility Total HVAC Electric Demand Power = Cooling (Electricity) + Heating (Electricity) + Auxiliary Energy + System pumps + System fans
!Facility total electric demand power = Facility Total HVAC Electric Demand Power + Facility Total Building Electric Demand Power
Output:Variable, *, Facility Total HVAC Electric Demand Power, Timestep;
